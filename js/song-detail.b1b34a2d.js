(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["song-detail"],{"077e":function(t,s,n){"use strict";var i=n("c4ee"),e=n.n(i);e.a},"7db0":function(t,s,n){"use strict";var i=n("23e7"),e=n("b727").find,a=n("44d2"),o="find",r=!0;o in[]&&Array(1)[o]((function(){r=!1})),i({target:"Array",proto:!0,forced:r},{find:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},b64b:function(t,s,n){var i=n("23e7"),e=n("7b0b"),a=n("df75"),o=n("d039"),r=o((function(){a(1)}));i({target:"Object",stat:!0,forced:r},{keys:function(t){return a(e(t))}})},c045:function(t,s,n){t.exports=n.p+"img/artist-active.5d66206a.svg"},c268:function(t,s,n){"use strict";n.r(s);var i=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"song-detail"},[i("app-top"),i("back",{on:{back:t.handleBack}}),i("div",{staticClass:"logo-pos"},[i("logo")],1),i("search-button"),i("corner-label",{attrs:{size:"md"}},[i("corner-tip",{attrs:{text:"歌曲"}}),i("div",{staticClass:"wrap"},[i("div",{staticClass:"pic",on:{click:function(s){t.showPhoto=!0}}},[i("img",{attrs:{src:t.song.al&&t.song.al.picUrl+"?param=250y250"}}),i("label",[t._v(t._s(t.formatSeconds(t.song.dt,1e3)))])]),i("h2",{staticClass:"name",on:{click:t.handlePlay}},[t.song.name&&t.url!=t.$store.state.player.url?i("img",{attrs:{src:n("e802")}}):t._e(),t._v(" "+t._s(t.song.name)),t.song.alia&&t.song.alia.length?i("label",[t._v("("+t._s(t.alias(t.song.alia))+")")]):t._e()]),i("p",{staticClass:"artist"},[i("img",{attrs:{src:n("c045")}}),t._l(t.artist,(function(s,n){return i("span",{key:n},[i("span",{staticClass:"art",on:{click:function(n){return t.handleArtist(s.id)}}},[t._v(t._s(s.name))]),t._v(t._s(n+1==t.artist.length?"":" / "))])}))],2),i("p",{staticClass:"albu",on:{click:function(s){return t.handleAlbum(t.song.al.id)}}},[i("label",[t._v("所属专辑：")]),t._v(t._s(t.song.al&&t.song.al.name))])])],1),t.lyric.length>0?i("div",{staticClass:"lyric"},[i("a",{staticClass:"toggle",on:{click:function(s){t.showLyric=!t.showLyric}}},[t._v(t._s(t.showLyric?"隐藏歌词":"显示歌词"))]),i("ul",{class:{show:t.showLyric,hide:!t.showLyric}},t._l(t.lyric,(function(s,n){return i("li",{key:n,class:{active:s.includes(t.$store.state.syncLyric.time)}},[t._v(t._s(s.replace(/\[.*\]/g,"")))])})),0)]):t._e(),i("h3",{staticClass:"title",class:{"margin-top":0==t.lyric.length}},[t._v("相似歌曲"),i("i",{staticClass:"total"},[t._v("共"+t._s(t.simiSongs.length)+"首")])]),i("ul",{staticClass:"list"},t._l(t.simiSongs,(function(s,n){return i("li",{key:n,on:{click:function(n){return t.handleSong(s.id)}}},[i("label",[t._v(t._s((""+(n+1)).padStart(t.simiSongs.length.toString().length,0)))]),i("span",{staticClass:"infos"},[i("span",{staticClass:"na"},[t._v(t._s(s.name)),s.alias.length?i("label",[t._v("("+t._s(t.alias(s.alias))+")")]):t._e()]),i("span",{staticClass:"ar"},[t._v(t._s(s.artists.reduce((function(t,n,i){return t+(n.name+(s.artists.length!=i+1?" / ":""))}),"")))])]),s.duration?i("label",{staticClass:"duration"},[t._v(t._s(t.formatSeconds(s.duration,1e3)))]):t._e()])})),0),i("comment",{attrs:{label:"歌曲评论",total:t.comment.total,hot:t.comment.hotComments,list:t.comment.comments,paging:t.fetchComment(t.$route.params.id),current:t.current}}),t.showPhoto?i("photo",{attrs:{pre:t.song.al.picUrl+"?param=250y250",url:t.song.al.picUrl},on:{close:function(s){t.showPhoto=!1}}}):t._e()],1)},e=[],a=(n("7db0"),n("d81d"),n("b0c0"),n("b64b"),n("ac1f"),n("1276"),n("34b2")),o=n("66b7"),r=n("2241"),c=n("9f7a"),l=n("1634"),h=n("19eb"),u=n("4ea3"),m=n("7856"),g=n("1d30"),d=n("182a"),p={name:"SongDetail",components:{AppTop:a["a"],Back:o["a"],Logo:r["a"],SearchButton:c["a"],CornerLabel:l["a"],CornerTip:h["a"],Comment:u["a"],Photo:m["a"]},data:function(){return{check:!1,url:null,song:{},artist:[],simiSongs:[],lyric:[],showLyric:!1,comment:{},current:1,showPhoto:!1}},watch:{"$route.params":function(){this.check=!1,this.url=null,this.showLyric=!1,this.current=1,this.init()},showLyric:function(t){var s=this.$store.state.player.url,n=!!s&&s==this.url;t&&n?this.$store.commit("setSyncLyric",{sync:!0}):this.$store.commit("setSyncLyric",{sync:!1})},"$store.state.player":function(t){this.showLyric&&t.url==this.url?this.$store.commit("setSyncLyric",{sync:!0}):this.$store.commit("setSyncLyric",{sync:!1})}},methods:{init:function(){var t=this,s=this.$route.params.id;this.$store.commit("setIsLoading",!0),this.$api.song.check(s).then((function(s){t.check=s.success})),this.$api.song.url(s).then((function(s){t.$store.commit("setIsLoading",!1),t.url=s.data[0].url})),this.$api.song.detail(s).then((function(s){t.$store.commit("setIsLoading",!1),200==s.code?(t.song=s.songs[0],t.song.ar&&(t.artist=t.song.ar.map((function(s){return{id:s.id,name:s.name,pic:t.song.al&&t.song.al.picUrl+"?param=80y80"}})))):t.$store.commit("setAlert",{type:"error",content:"获取歌曲详情失败"})})),this.$api.song.simiSong(s).then((function(s){t.$store.commit("setIsLoading",!1),200==s.code?t.simiSongs=s.songs:t.$store.commit("setAlert",{type:"error",content:"获取相似歌曲失败"})})),this.$api.song.lyric(s).then((function(s){200==s.code&&s.lrc&&s.lrc.lyric&&(t.lyric=s.lrc.lyric.split("\n"))})),this.fetchComment(s)(1)},alias:g["a"],formatSeconds:d["a"],handleBack:function(){history.back()},handlePlay:function(){var t=this,s=this.$store.state.player.list;this.check?this.url&&0!=Object.keys(this.song).length?s.find((function(s){return s.id==t.song.id}))?this.$store.commit("setAlert",{type:"prompt",content:"歌曲已添加到播放列表"}):(this.song["_url"]=this.url,this.song["_lyric"]=this.lyric,s.unshift(this.song),this.$store.commit("setPlayer",{url:this.url,play:!0,index:0,list:s,lyric:this.lyric,isPlayed:this.$store.state.player.isPlayed}),this.showLyric&&this.$store.commit("setSyncLyric",{sync:!0})):this.$store.commit("setAlert",{type:"error",content:"歌曲无播放资源"}):this.$store.commit("setAlert",{type:"error",content:"歌曲暂无版权"})},handleArtist:function(t){this.$router.push({name:"artistDetail",params:{id:t}})},handleSong:function(t){this.$router.push({name:"songDetail",params:{id:t}})},handleAlbum:function(t){this.$router.push({name:"albumDetail",params:{id:t}})},fetchComment:function(t){var s=this;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=10;s.current=n,s.$api.song.comment(t,(s.current-1)*i,i).then((function(t){200==t.code&&(s.comment=t)}))}}},created:function(){this.init()}},y=p,f=(n("077e"),n("2877")),_=Object(f["a"])(y,i,e,!1,null,"3411c788",null);s["default"]=_.exports},c4ee:function(t,s,n){},e802:function(t,s,n){t.exports=n.p+"img/play-circle.2c8ead7c.svg"}}]);